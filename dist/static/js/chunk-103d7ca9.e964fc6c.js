(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-103d7ca9"],{"333d":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[n("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},a=[];n("c5f6");Math.easeInOutQuad=function(t,e,n,o){return t/=o/2,t<1?n/2*t*t+e:(t--,-n/2*(t*(t-2)-1)+e)};var r=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function i(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function c(t,e,n){var o=l(),a=t-o,c=20,u=0;e="undefined"===typeof e?500:e;var s=function t(){u+=c;var l=Math.easeInOutQuad(u,o,a,e);i(l),u<e?r(t):n&&"function"===typeof n&&n()};s()}var u={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.$emit("update:limit",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,limit:t}),this.autoScroll&&c(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,limit:this.pageSize}),this.autoScroll&&c(0,800)}}},s=u,d=(n("e498"),n("2877")),f=Object(d["a"])(s,o,a,!1,null,"6af373ef",null);e["a"]=f.exports},4381:function(t,e,n){"use strict";n("6762"),n("2fdb");var o=n("4360"),a={inserted:function(t,e,n){var a=e.value,r=o["a"].getters&&o["a"].getters.roles;if(!(a&&a instanceof Array&&a.length>0))throw new Error("need roles! Like v-permission=\"['admin','editor']\"");var i=a,l=r.some((function(t){return i.includes(t)}));l||t.parentNode&&t.parentNode.removeChild(t)}},r=function(t){t.directive("permission",a)};window.Vue&&(window["permission"]=a,Vue.use(r)),a.install=r;e["a"]=a},"4e0a":function(t,e,n){},5723:function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return r})),n.d(e,"e",(function(){return i})),n.d(e,"a",(function(){return l})),n.d(e,"f",(function(){return c}));var o=n("b775");function a(t){return Object(o["a"])({url:"/account/".concat(t),method:"get"})}function r(t){return Object(o["a"])({url:"/account/generatorSubscriptionUrl",method:"get",data:t})}function i(t){return Object(o["a"])({url:"/account/v2rayAccount",method:"get",params:t})}function l(t){return Object(o["a"])({url:"/account",method:"get",params:t})}function c(t){return Object(o["a"])({url:"/account",method:"put",data:t})}},7456:function(t,e,n){},"99de":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container "},[n("el-row",{attrs:{gutter:15}},[n("el-col",{attrs:{span:3}},[n("el-input",{attrs:{placeholder:"email"},model:{value:t.listQuery.userEmail,callback:function(e){t.$set(t.listQuery,"userEmail",e)},expression:"listQuery.userEmail"}})],1),t._v(" "),n("el-col",{attrs:{span:2}},[n("el-button",{on:{click:t.getList}},[t._v("搜索")])],1)],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.list,fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{align:"left",label:"账号信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("span",[t._v("用户："+t._s(e.row.userVO?e.row.userVO.email:""))])]),t._v(" "),n("div",[n("span",[t._v("备注："+t._s(e.row.userVO?e.row.userVO.remark:""))])]),t._v(" "),n("div",[n("span",[t._v("账号："+t._s(e.row.accountNo))])])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"left",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("span",[t._v(" 有效时间： ")]),t._v(" "),n("span",[e.row.toDate>(new Date).getTime()?n("font",[t._v("  "+t._s(t._f("parseTime")(e.row.toDate,"{y}-{m}-{d} {h}:{i}")))]):n("font",{attrs:{color:"red"}},[t._v("  "+t._s(t._f("parseTime")(e.row.toDate,"{y}-{m}-{d} {h}:{i}")))])],1)]),t._v(" "),e.row.statVO?n("div",[n("span",[t._v("结算时间："+t._s(t._f("parseTime")(e.row.statVO.toDate,"{y}-{m}-{d} {h}:{i}")))])]):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"left",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("span",[t._v("速率："+t._s(t._f("speedFilter")(e.row.speed)))])]),t._v(" "),n("div",[t._v("周期："+t._s(e.row.cycle)+"天/周期")]),t._v(" "),n("div",[t._v("流量："),n("span",[(e.row.statVO?(e.row.statVO.flow/1024/1024/1024).toFixed(2):0)<e.row.bandwidth?n("font",[t._v(t._s(e.row.statVO?(e.row.statVO.flow/1024/1024/1024).toFixed(2):0))]):n("font",{attrs:{color:"red"}},[t._v(t._s(e.row.statVO?(e.row.statVO.flow/1024/1024/1024).toFixed(2):0))]),t._v("\n           /"+t._s(e.row.bandwidth)+"GB/周期")],1)])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"left",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[t._v("单服务器连接数："+t._s(e.row.maxConnection)+"/账号")]),t._v(" "),n("div",[t._v("账号等级:"+t._s(t._f("levelFilter")(e.row.level)))]),t._v(" "),n("div",[t._v("账号状态:"+t._s(t._f("accountStatusFilter")(e.row.status)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"left",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("el-link",{attrs:{icon:"el-icon-edit",type:"primary"},on:{click:function(n){return t.openAccountDidlog(e.row)}}},[t._v("编辑账号")])],1)]}}])})],1),t._v(" "),n("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.pageSize},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"pageSize",e)},pagination:t.getList}}),t._v(" "),n("el-dialog",{attrs:{title:"修改",visible:t.accountDialog,"before-close":t.handlerAccountCloseDialog},on:{"update:visible":function(e){t.accountDialog=e}}},[n("el-form",{ref:"accountForm",attrs:{model:t.accountForm,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"账号"}},[n("el-input",{model:{value:t.accountForm.accountNo,callback:function(e){t.$set(t.accountForm,"accountNo",e)},expression:"accountForm.accountNo"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"周期"}},[n("el-input",{model:{value:t.accountForm.cycle,callback:function(e){t.$set(t.accountForm,"cycle",e)},expression:"accountForm.cycle"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"有效期"}},[n("el-date-picker",{attrs:{"value-format":"timestamp",type:"datetime"},model:{value:t.accountForm.fromDate,callback:function(e){t.$set(t.accountForm,"fromDate",e)},expression:"accountForm.fromDate"}}),t._v(" "),n("span",[t._v("to")]),t._v(" "),n("el-date-picker",{attrs:{"value-format":"timestamp",type:"datetime"},model:{value:t.accountForm.toDate,callback:function(e){t.$set(t.accountForm,"toDate",e)},expression:"accountForm.toDate"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"增加N天"}},[n("el-input",{attrs:{size:"medium"},model:{value:t.accountForm.addDay,callback:function(e){t.$set(t.accountForm,"addDay",e)},expression:"accountForm.addDay"}},[n("el-button",{attrs:{slot:"append"},on:{click:t.addToDate},slot:"append"},[t._v("增加")])],1)],1),t._v(" "),n("el-form-item",{attrs:{label:"速率"}},[n("el-input",{model:{value:t.accountForm.speed,callback:function(e){t.$set(t.accountForm,"speed",e)},expression:"accountForm.speed"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"流量"}},[n("el-input",{model:{value:t.accountForm.bandwidth,callback:function(e){t.$set(t.accountForm,"bandwidth",e)},expression:"accountForm.bandwidth"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"连接数"}},[n("el-input",{model:{value:t.accountForm.maxConnection,callback:function(e){t.$set(t.accountForm,"maxConnection",e)},expression:"accountForm.maxConnection"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"账号等级",prop:"level"}},[n("el-select",{model:{value:t.accountForm.level,callback:function(e){t.$set(t.accountForm,"level",e)},expression:"accountForm.level"}},t._l(t.levelOptions,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"状态"}},[n("el-select",{attrs:{placeholder:"状态"},model:{value:t.accountForm.status,callback:function(e){t.$set(t.accountForm,"status",e)},expression:"accountForm.status"}},t._l(t.accountFormOptions,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),n("el-form-item",[n("el-button",{on:{click:t.submitUpdateAccount}},[t._v("提交")])],1)],1)],1)],1)},a=[],r=n("bd86"),i=n("5723"),l=n("aa22"),c=n("333d"),u=n("f71e"),s=n("27ae"),d=n("658f"),f=n.n(d),m=n("4360"),p=(n("3022"),n("4381")),v=864e5,g={name:"UserAccount",components:{Pagination:c["a"],VueQr:f.a},directives:{permission:p["a"]},filters:{accountStatusFilter:function(t){var e={1:"正常",0:"禁用"};return e[t]},speedFilter:function(t){return t<=1024?"流畅":t>1024&&t<=2024?"高速":"极速"},levelFilter:function(t){var e={0:"等级0",1:"等级1",2:"等级2",3:"等级3"};return e[t]},statusFilter:function(t){var e={1:"success",0:"danger"};return e[t]},statusFilter2:function(t){var e={1:"在线",0:"下线"};return e[t]}},data:function(){var t;return{levelOptions:[{value:0,label:"等级0"},{value:1,label:"等级1"},{value:2,label:"等级2"},{value:3,label:"等级3"}],accountFormOptions:[{value:1,label:"正常"},{value:0,label:"禁止"}],accountForm:(t={id:null,fromDate:null,toDate:null,cycle:null,accountNo:null,status:null,bandwidth:null},Object(r["a"])(t,"fromDate",null),Object(r["a"])(t,"fromDate",null),Object(r["a"])(t,"status","1"),Object(r["a"])(t,"addDay",0),Object(r["a"])(t,"level",0),t),accountDialog:!1,roles:m["a"].getters.roles,toColip:"",opAccountId:null,serverTotal:0,chooseServerId:null,serverListQuery:{page:1,pageSize:10},serverDialog:!1,serverList:null,list:null,total:0,listLoading:!0,listQuery:{page:1,pageSize:50,userEmail:""}}},computed:{},created:function(){this.getList()},methods:{onChange:function(t){console.log(t)},addToDate:function(){var t=this.accountForm.toDate;this.accountForm.toDate=t+v*this.accountForm.addDay},handlerAccountCloseDialog:function(t){t()},openAccountDidlog:function(t){this.accountForm=t,this.accountDialog=!0},handlerCopy:function(t,e){Object(u["a"])(t,e)},submitUpdateAccount:function(){var t=this;console.log(this.accountForm),this.accountForm.content=null,Object(i["f"])(this.accountForm).then((function(e){t.$message.success("提交成功"),t.getList()}))},submitUpdateServer:function(){var t=this;if(!this.chooseServerId)return this.$message.error("请选择服务器"),void this.$refs.multipleTable.clearSelection();var e={id:this.opAccountId,serverId:this.chooseServerId};Object(i["updateAccountServer"])(e).then((function(e){t.$message.success("提交成功,原账号将失效,请使用新账号"),t.getList()}))},handlerServerCloseDialog:function(t){this.$refs.multipleTable.clearSelection(),this.chooseServerId=null,this.opAccountId=null,t()},handleCurrentChange:function(t){if(this.chooseServerId=null,t.length>1)this.$message.error("只能选择一个服务器");else if(!(t.length<1)){var e=t[0];this.chooseServerId=e&&e.id?e.id:null,console.log(this.chooseServerId)}},getServerList:function(){var t=this;Object(l["e"])(this.serverListQuery).then((function(e){t.serverList=e.obj.content,t.serverTotal=e.obj.total}))},changeServerDidlog:function(t){this.serverDialog=!0,this.opAccountId=t,this.getServerList()},formatDate:function(t){if(!t)return"";var e=t.getFullYear(),n=t.getMonth()+1,o=(t=t.getDate(),t.getHours()),a=t.getMinutes(),r=t.getSeconds();return e+"-"+n+"-"+t+" "+o+":"+a+":"+r},getList:function(){var t=this,e=this.roles.indexOf("admin")>-1;this.listLoading=!0;var n=e?Object(i["a"])(this.listQuery):Object(i["getAccounts"])(1);n.then((function(e){t.list=e.obj.content;for(var n=0;n<t.list.length;n++){var o=t.list[n].content;t.list[n].content=o?JSON.parse(o):{},t.list[n].toColip="vmess://"+s["Base64"].encode(o)}t.total=e.obj.total,t.listLoading=!1}))}}},h=g,b=(n("b5eb"),n("2877")),_=Object(b["a"])(h,o,a,!1,null,"7b9afdda",null);e["default"]=_.exports},aa22:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"f",(function(){return r})),n.d(e,"d",(function(){return i})),n.d(e,"e",(function(){return l})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return u}));var o=n("b775");function a(t){return Object(o["a"])({url:"/server",method:"post",data:t})}function r(t){return Object(o["a"])({url:"/server",method:"put",data:t})}function i(t){return Object(o["a"])({url:"/server/".concat(t),method:"get"})}function l(t){return Object(o["a"])({url:"/server",method:"get",params:t})}function c(){return Object(o["a"])({url:"/server/findServersForAccount",method:"get"})}function u(t){return Object(o["a"])({url:"/server/".concat(t),method:"DELETE"})}},b5eb:function(t,e,n){"use strict";n("4e0a")},e498:function(t,e,n){"use strict";n("7456")},f71e:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var o=n("2b0e"),a=n("b311"),r=n.n(a);function i(){o["default"].prototype.$message({message:"复制成功",type:"success",duration:1500})}function l(){o["default"].prototype.$message({message:"复制失败",type:"error"})}function c(t,e){var n=new r.a(e.target,{text:function(){return t}});n.on("success",(function(){i(),n.destroy()})),n.on("error",(function(){l(),n.destroy()})),n.onClick(e)}}}]);